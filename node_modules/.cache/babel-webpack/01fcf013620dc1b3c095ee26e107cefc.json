{"ast":null,"code":"import _asyncToGenerator from \"/home/cristian/Escritorio/ciatTest/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { MessageService } from 'primeng/api';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport Cookies from 'universal-cookie/es6';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"primeng/api\";\nimport * as i2 from \"../../services/apiService/api.service\";\nimport * as i3 from \"../../firebase-storage.service\";\nimport * as i4 from \"primeng/toolbar\";\nimport * as i5 from \"primeng/table\";\nimport * as i6 from \"primeng/dialog\";\nimport * as i7 from \"primeng/toast\";\nimport * as i8 from \"primeng/button\";\nimport * as i9 from \"primeng/ripple\";\nimport * as i10 from \"primeng/inputtext\";\nimport * as i11 from \"@angular/common\";\nimport * as i12 from \"@angular/forms\";\nimport * as i13 from \"primeng/progressspinner\";\n\nfunction SettingComponent_ng_template_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function SettingComponent_ng_template_8_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.openNew();\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SettingComponent_ng_template_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵelementStart(1, \"h5\", 15);\n    i0.ɵɵtext(2, \"Administrar Plagas\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\", 16);\n    i0.ɵɵelement(4, \"input\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SettingComponent_ng_template_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"th\", 18);\n    i0.ɵɵelement(2, \"p-tableHeaderCheckbox\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"th\", 19);\n    i0.ɵɵtext(4, \"Id \");\n    i0.ɵɵelement(5, \"p-sortIcon\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\", 21);\n    i0.ɵɵtext(7, \"nombre de la plaga\");\n    i0.ɵɵelement(8, \"p-sortIcon\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(9, \"th\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SettingComponent_ng_template_12_tr_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵelement(2, \"p-tableCheckbox\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const plaga_r8 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"value\", plaga_r8);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(plaga_r8.id_plaga);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(plaga_r8.nombre_plaga);\n  }\n}\n\nfunction SettingComponent_ng_template_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, SettingComponent_ng_template_12_tr_0_Template, 7, 3, \"tr\", 23);\n  }\n\n  if (rf & 2) {\n    const plaga_r8 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngIf\", plaga_r8.id_plaga != 1);\n  }\n}\n\nfunction SettingComponent_ng_template_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 25);\n    i0.ɵɵelementStart(1, \"label\", 26);\n    i0.ɵɵtext(2, \"Nombre de la plaga\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"input\", 27);\n    i0.ɵɵlistener(\"ngModelChange\", function SettingComponent_ng_template_14_Template_input_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.nombre = $event;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r4.nombre);\n  }\n}\n\nfunction SettingComponent_ng_template_15_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 31);\n    i0.ɵɵlistener(\"click\", function SettingComponent_ng_template_15_button_1_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext(2);\n      return ctx_r15.savePlaga();\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c0 = function () {\n  return {\n    width: \"50px\",\n    height: \"50px\"\n  };\n};\n\nfunction SettingComponent_ng_template_15_p_progressSpinner_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"p-progressSpinner\", 32);\n  }\n\n  if (rf & 2) {\n    i0.ɵɵstyleMap(i0.ɵɵpureFunction0(2, _c0));\n  }\n}\n\nfunction SettingComponent_ng_template_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 28);\n    i0.ɵɵlistener(\"click\", function SettingComponent_ng_template_15_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return ctx_r17.hideDialog();\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(1, SettingComponent_ng_template_15_button_1_Template, 1, 0, \"button\", 29);\n    i0.ɵɵtemplate(2, SettingComponent_ng_template_15_p_progressSpinner_2_Template, 1, 3, \"p-progressSpinner\", 30);\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r5.finalizado);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.finalizado);\n  }\n}\n\nconst _c1 = function () {\n  return [\"name\", \"country.name\", \"representative.name\", \"status\"];\n};\n\nconst _c2 = function () {\n  return {\n    width: \"450px\"\n  };\n};\n\nexport let SettingComponent = /*#__PURE__*/(() => {\n  class SettingComponent {\n    constructor(messageService, firestoreService, firebaseStorage) {\n      this.messageService = messageService;\n      this.firestoreService = firestoreService;\n      this.firebaseStorage = firebaseStorage;\n      this.products = [];\n      this.categorias = [];\n      this.tallas = [];\n      this.nombre = '';\n      this.mensajeArchivo = 'No hay un archivo seleccionado';\n      this.datosFormulario = new FormData();\n      this.nombreArchivo = '';\n      this.URLPublica = '';\n      this.porcentaje = 0;\n      this.finalizado = false;\n      this.product = {\n        id: 0,\n        category: '',\n        code: 0,\n        description: '',\n        image: '',\n        inventoryStatus: 'DISPONIBLE',\n        longDescription: '',\n        name: '',\n        price: 0,\n        quantity: 0,\n        rating: 5,\n        tallas: ''\n      };\n      this.submitted = false;\n      this.productDialog = false;\n      this.archivoForm = new FormGroup({\n        archivo: new FormControl(null, Validators.required)\n      });\n      this.obtenerPlaga();\n    }\n\n    obtenerPlaga() {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        const cookies = new Cookies();\n        const headers = {\n          authorization: 'Bearer ' + cookies.get('token')\n        };\n        yield _this.firestoreService.getPlaga(headers).then(res => {\n          _this.plaga = res.data;\n        });\n        console.log(_this.plaga);\n      })();\n    }\n\n    onRowSelect(event) {\n      console.log(event.data);\n      this.icono = event.data.icon;\n      this.messageService.add({\n        severity: 'info',\n        summary: 'Product Selected',\n        detail: event.data.name\n      });\n    }\n\n    onUpload(event) {\n      for (let file of event.files) {\n        this.image.push(file);\n      }\n\n      console.log(this.image);\n    } //Evento que se gatilla cuando el input de tipo archivo cambia\n\n\n    cambioArchivo(event) {\n      console.log(event);\n\n      if (event.files.length > 0) {\n        for (let i = 0; i < event.files.length; i++) {\n          this.mensajeArchivo = `Archivo preparado: ${event.files[i].name}`;\n          this.nombreArchivo = event.files[i].name;\n          this.datosFormulario.delete('archivo');\n          this.datosFormulario.append('archivo', event.files[i], event.files[i].name);\n        }\n      } else {\n        this.mensajeArchivo = 'No hay un archivo seleccionado';\n      }\n    } //Sube el archivo a Cloud Storage\n\n\n    subirArchivo() {\n      let archivo = this.datosFormulario.get('archivo');\n      let tarea = this.firebaseStorage.tareaCloudStorage(this.nombreArchivo, archivo).then(res => {\n        this.firebaseStorage.referenciaCloudStorage(this.nombreArchivo).getDownloadURL().subscribe(resultado => {\n          this.URLPublica = resultado;\n        });\n        let referencia = this.firebaseStorage.referenciaCloudStorage(this.nombreArchivo);\n        referencia.getDownloadURL().subscribe(URL => {\n          this.URLPublica = URL;\n          this.product.image = URL;\n          console.log(this.image);\n        });\n      });\n    }\n\n    ngOnInit() {}\n\n    openNew() {\n      this.product = {\n        id: this.products.length + 1,\n        category: '',\n        code: this.products.length + 1,\n        description: '',\n        image: '',\n        inventoryStatus: 'DISPONIBLE',\n        longDescription: '',\n        name: '',\n        price: 0,\n        quantity: 0,\n        rating: 5,\n        tallas: ''\n      };\n      this.submitted = false;\n      this.productDialog = true;\n    }\n\n    hideDialog() {\n      this.productDialog = false;\n      this.submitted = false;\n      this.product = {\n        id: 0,\n        category: '',\n        code: 0,\n        description: '',\n        image: '',\n        inventoryStatus: 'DISPONIBLE',\n        longDescription: '',\n        name: '',\n        price: 0,\n        quantity: 0,\n        rating: 5,\n        tallas: ''\n      };\n    }\n\n    savePlaga() {\n      var plaga = {\n        id_plaga: 0,\n        nombre: this.nombre\n      };\n      const cookies = new Cookies();\n      const headers = {\n        authorization: 'Bearer ' + cookies.get('token')\n      };\n      this.firestoreService.postPlaga(plaga, headers).then(res => {\n        console.log(res);\n        this.productDialog = false;\n        this.nombre = '';\n        this.messageService.add({\n          severity: 'success',\n          summary: 'Genial',\n          detail: 'Se creo la plaga exitosamente',\n          life: 5000\n        });\n      });\n    }\n\n  }\n\n  SettingComponent.ɵfac = function SettingComponent_Factory(t) {\n    return new (t || SettingComponent)(i0.ɵɵdirectiveInject(i1.MessageService), i0.ɵɵdirectiveInject(i2.FirestoreService), i0.ɵɵdirectiveInject(i3.FirebaseStorageService));\n  };\n\n  SettingComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SettingComponent,\n    selectors: [[\"app-setting\"]],\n    features: [i0.ɵɵProvidersFeature([MessageService])],\n    decls: 17,\n    vars: 12,\n    consts: [[1, \"ml-8\", \"pt-8\"], [1, \"text-5xl\"], [1, \"flex\", \"justify-content-center\", \"flex-wrap\", \"card-container\"], [1, \"card\", \"w-11\", \"justify-content-center\", \"m-auto\", \"mt-4\", \"mb-8\"], [\"styleClass\", \"mb-4\"], [\"pTemplate\", \"left\"], [\"responsiveLayout\", \"scroll\", \"dataKey\", \"id\", \"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", 3, \"value\", \"rows\", \"paginator\", \"globalFilterFields\", \"rowHover\", \"showCurrentPageReport\"], [\"pTemplate\", \"caption\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"header\", \"Administrar tus plagas\", \"styleClass\", \"p-fluid\", 3, \"visible\", \"modal\", \"visibleChange\"], [\"pTemplate\", \"content\"], [\"pTemplate\", \"footer\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Agregar\", \"icon\", \"pi pi-plus\", 1, \"p-button-success\", \"mr-2\", 3, \"click\"], [1, \"flex\", \"align-items-center\", \"justify-content-between\"], [1, \"m-0\"], [1, \"p-input-icon-left\"], [\"pInputText\", \"\", \"type\", \"text\", \"placeholder\", \"Search...\"], [2, \"width\", \"3rem\"], [\"pSortableColumn\", \"name\"], [\"field\", \"name\"], [\"pSortableColumn\", \"price\"], [\"field\", \"price\"], [4, \"ngIf\"], [3, \"value\"], [1, \"p-field\"], [\"for\", \"name\"], [\"type\", \"text\", \"pInputText\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Cancelar\", \"icon\", \"pi pi-times\", 1, \"p-button-text\", 3, \"click\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Guardar\", \"icon\", \"pi pi-check\", \"class\", \"p-button-text\", 3, \"click\", 4, \"ngIf\"], [\"styleClass\", \"custom-spinner\", \"strokeWidth\", \"8\", \"fill\", \"var(--surface-ground)\", \"animationDuration\", \".5s\", 3, \"style\", 4, \"ngIf\"], [\"pButton\", \"\", \"pRipple\", \"\", \"label\", \"Guardar\", \"icon\", \"pi pi-check\", 1, \"p-button-text\", 3, \"click\"], [\"styleClass\", \"custom-spinner\", \"strokeWidth\", \"8\", \"fill\", \"var(--surface-ground)\", \"animationDuration\", \".5s\"]],\n    template: function SettingComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"p\", 1);\n        i0.ɵɵtext(2, \"Plagas\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"p\");\n        i0.ɵɵtext(4, \"Administre las plagas que pueden afectar el cultivo\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"div\", 2);\n        i0.ɵɵelementStart(6, \"div\", 3);\n        i0.ɵɵelementStart(7, \"p-toolbar\", 4);\n        i0.ɵɵtemplate(8, SettingComponent_ng_template_8_Template, 1, 0, \"ng-template\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"p-table\", 6);\n        i0.ɵɵtemplate(10, SettingComponent_ng_template_10_Template, 5, 0, \"ng-template\", 7);\n        i0.ɵɵtemplate(11, SettingComponent_ng_template_11_Template, 10, 0, \"ng-template\", 8);\n        i0.ɵɵtemplate(12, SettingComponent_ng_template_12_Template, 1, 1, \"ng-template\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"p-dialog\", 10);\n        i0.ɵɵlistener(\"visibleChange\", function SettingComponent_Template_p_dialog_visibleChange_13_listener($event) {\n          return ctx.productDialog = $event;\n        });\n        i0.ɵɵtemplate(14, SettingComponent_ng_template_14_Template, 4, 1, \"ng-template\", 11);\n        i0.ɵɵtemplate(15, SettingComponent_ng_template_15_Template, 3, 2, \"ng-template\", 12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(16, \"p-toast\");\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"value\", ctx.plaga)(\"rows\", 5)(\"paginator\", true)(\"globalFilterFields\", i0.ɵɵpureFunction0(10, _c1))(\"rowHover\", true)(\"showCurrentPageReport\", true);\n        i0.ɵɵadvance(4);\n        i0.ɵɵstyleMap(i0.ɵɵpureFunction0(11, _c2));\n        i0.ɵɵproperty(\"visible\", ctx.productDialog)(\"modal\", true);\n      }\n    },\n    directives: [i4.Toolbar, i1.PrimeTemplate, i5.Table, i6.Dialog, i7.Toast, i8.ButtonDirective, i9.Ripple, i10.InputText, i5.TableHeaderCheckbox, i5.SortableColumn, i5.SortIcon, i11.NgIf, i5.TableCheckbox, i12.DefaultValueAccessor, i12.NgControlStatus, i12.NgModel, i13.ProgressSpinner],\n    styles: [\".contenedor[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%}.contenedor[_ngcontent-%COMP%]   .contenedor-formulario[_ngcontent-%COMP%]{width:400px}.contenedor[_ngcontent-%COMP%]   .download[_ngcontent-%COMP%]{background:#1081ff;color:#fff;padding:10px 20px;margin-bottom:20px}.contenedor[_ngcontent-%COMP%]   .download[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:underline;color:#fff}\"]\n  });\n  return SettingComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}